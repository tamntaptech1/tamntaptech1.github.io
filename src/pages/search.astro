---
import BaseLayout from '../layouts/BaseLayout.astro';

const basePath = import.meta.env.PUBLIC_BASE_PATH || '/tamntaptech1.github.io';
---

<BaseLayout title="Search | Tam Nguyen" description="Search the blog">
  <div class="mx-auto max-w-3xl px-4 sm:px-6 lg:px-8 py-16">
    <header class="mb-8">
      <h1 class="text-4xl font-bold text-gray-900 dark:text-gray-100 mb-4">
        Search
      </h1>
      <p class="text-xl text-gray-600 dark:text-gray-400">
        Find articles by keywords, topics, or phrases
      </p>
    </header>

    <div class="search-container">
      <div id="search"></div>
    </div>

    <noscript>
      <div class="p-4 bg-yellow-100 dark:bg-yellow-900/30 border border-yellow-300 dark:border-yellow-700 rounded-lg">
        <p class="text-yellow-800 dark:text-yellow-200">
          JavaScript is required for search functionality. Please enable JavaScript in your browser.
        </p>
      </div>
    </noscript>
  </div>
</BaseLayout>

<link href={`${basePath}/_pagefind/pagefind-ui.css`} rel="stylesheet" />

<style>
  /* Override Pagefind CSS variables to respect dark mode */
  .search-container {
    --pagefind-ui-primary: theme('colors.primary.600');
    --pagefind-ui-text: theme('colors.gray.900');
    --pagefind-ui-background: theme('colors.gray.50');
    --pagefind-ui-border: theme('colors.gray.200');
    --pagefind-ui-tag: theme('colors.gray.600');
    --pagefind-ui-placeholder: theme('colors.gray.400');
    --pagefind-ui-shadow: 0 2px 8px theme('colors.gray.200');
  }

  .dark .search-container {
    --pagefind-ui-primary: theme('colors.primary.400');
    --pagefind-ui-text: theme('colors.gray.100');
    --pagefind-ui-background: theme('colors.gray.900');
    --pagefind-ui-border: theme('colors.gray.700');
    --pagefind-ui-tag: theme('colors.gray.400');
    --pagefind-ui-placeholder: theme('colors.gray.500');
    --pagefind-ui-shadow: 0 2px 8px theme('colors.gray.800');
  }
</style>

<script src={`${basePath}/_pagefind/pagefind-ui.js`}></script>
<script>
  // Load Pagefind after the page loads
  window.addEventListener('DOMContentLoaded', () => {
    // @ts-ignore - Pagefind is loaded dynamically
    if (typeof pagefindui !== 'undefined') {
      // @ts-ignore
      new pagefindui({
        element: '#search',
        showSubResults: true,
        showImages: false,
        translations: {
          placeholder: 'Search articles...',
        },
      });
    }
  });
</script>
